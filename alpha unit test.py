import numpy as np

n = 5

pi = [1/5]*5

transition_pb = np.array([[ 0.35792595 , 0.23850079 , 0.06164011 , 0.1497544  , 0.19217875],
 [ 0.1989225  , 0.10559366 , 0.24922098 , 0.2321442  , 0.21411865],
 [ 0.36852727 , 0.25102652 , 0.16281251 , 0.01648443 , 0.20114927],
 [ 0.15373549 , 0.24430813 , 0.23105497 , 0.23144086 , 0.13946055],
 [ 0.06506047 , 0.28667179 , 0.29042793 , 0.21640012 , 0.14143969]])

emission_pb = np.array([[  3.49222797e-02  , 5.93186855e-02  , 1.37877557e-01  , 5.28910956e-02  , 1.74309909e-01  , 2.25910991e-01  , 1.96731663e-01  , 1.18037819e-01],
 [  1.70931917e-01  , 2.33210942e-04  , 3.62858283e-02  , 1.14005256e-01  , 2.33519810e-01  , 2.07941115e-01  , 1.56667771e-01  , 8.04150924e-02],
 [  3.97750668e-02  , 1.97860653e-01  , 1.05090722e-01  , 2.28404929e-01  , 1.44600395e-01  , 6.44913042e-02  , 1.62256854e-01  , 5.75200764e-02],
 [  1.50206351e-01  , 1.14084853e-01  , 1.60050052e-01  , 2.65061196e-02  , 2.80674228e-01  , 1.24189700e-02  , 5.91779463e-03  , 2.50141632e-01],
 [  3.42784147e-02  , 1.46704206e-01 ,  2.09171508e-01  , 8.31292436e-02  ,  2.17390667e-01  , 1.29920784e-01 , 7.82411785e-02  , 1.01163998e-01]])


sequence = [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 4.0, 5.0, 5.0, 5.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 1.0]

alpha_v = np.ndarray(shape=(n, len(sequence)))
alpha_v[:, 0] = pi * emission_pb[:, sequence[0]]

for t in range(len(sequence) - 1):
    f = alpha_v[:, t].reshape(n, 1)
    alpha_v[:, t + 1] = np.sum(f * transition_pb, axis=0) * emission_pb[:, sequence[t + 1]]


print( alpha_v)
alpha_0_t1 = 2.25910991e-01*(4.51821982e-02*0.35792595 + 4.15882230e-02*0.1989225 +1.28982608e-02*0.36852727 +2.48379400e-03*0.15373549 +2.59841568e-02*0.06506047 )
alpha_2_t1 = emission_pb[2,5]*(4.51821982e-02*transition_pb[0,2] + 4.15882230e-02*transition_pb[1,2] +1.28982608e-02*transition_pb[2,2] +2.48379400e-03*transition_pb[3,2] +2.59841568e-02*transition_pb[4,2] )

print(alpha_0_t1)
print(alpha_2_t1)

ev = np.sum(alpha_v[:, -1])
print("ev",ev)
